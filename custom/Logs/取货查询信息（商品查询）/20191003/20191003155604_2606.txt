select t2.goods_name,t2.goods_price,t2.unit,(goods_total-sum(t1.quantity) ) as remain,(t2.goods_price*(goods_total-sum(t1.quantity) ))sum from food_order t1 join tab_mall_info t2 on t1.goods_name = t2.goods_name  where state in ('1','2')    and order_date like  '%2019-10-03%'   GROUP BY t2.goods_name select t1.goods_name,sum(t1.quantity) quantity,t2.goods_price,t2.unit,sum(t1.money)sum from food_order t1 join tab_mall_info t2 on t1.goods_name = t2.goods_name where state in ('1','2')    and order_date like  '%2019-10-03%'  group by t1.goods_name
