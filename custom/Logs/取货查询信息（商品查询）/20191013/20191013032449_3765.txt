select t1.goods_name,t2.goods_price,t2.unit,(goods_total-sum(t1.quantity) ) as remain,(t2.goods_price*(goods_total-sum(t1.quantity) ))sum from tab_mall_tran t1 join tab_mall_info t2 on t1.postID = t2.postID  where state in ('已提货','待取货')    and tran_date like  '%2019-10-13%'   GROUP BY t2.goods_name,t2.postID select t1.goods_name,sum(t1.quantity) quantity,t2.goods_price,t2.unit,sum(t1.money)sum from tab_mall_tran t1 join tab_mall_info t2 on t1.postID = t2.postID where state in ('已提货','待取货')    and tran_date like  '%2019-10-13%'  group by t2.goods_name,t2.postID 
